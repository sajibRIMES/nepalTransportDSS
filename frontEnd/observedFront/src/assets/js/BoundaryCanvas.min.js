/**
 * Minified by jsDelivr using UglifyJS v3.1.10.
 * Original file: /npm/leaflet-boundary-canvas@1.0.0/src/BoundaryCanvas.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function()
{var t=function(t,e){if(4!==t.length)return!1;var i,n=0,r=0;for(i=0;i<4;i++){if(t[i].x!==e.min.x&&t[i].x!==e.max.x||t[i].y!==e.min.y&&t[i].y!==e.max.y)return!1;n+=t[i].x,r+=t[i].y}return n===2*(e.min.x+e.max.x)&&r===2*(e.min.y+e.max.y)},e={_toMercGeometry:function(t,e){var i,n,r,o,a,s,l=[];for(e||(t[0]instanceof Array?t[0][0]instanceof Array||(t=[t]):t=[[t]]),i=0;i<t.length;i++){for(o=[],n=0;n<t[i].length;n++){for(a=[],r=0;r<t[i][n].length;r++)s=e?L.latLng(t[i][n][r][1],t[i][n][r][0]):t[i][n][r],a.push(this._map.project(s,0));o.push(a)}l.push(o)}return l},_getOriginalMercBoundary:function(){if(this._mercBoundary)return this._mercBoundary;var t;if(L.Util.isArray(this.options.boundary))this._mercBoundary=this._toMercGeometry(this.options.boundary);else{this._mercBoundary=[];var e=function(t){"GeometryCollection"===t.type?t.geometries.forEach(e):"Feature"===t.type?e(t.geometry):"FeatureCollection"===t.type?t.features.forEach(e):"Polygon"===t.type?this._mercBoundary=this._mercBoundary.concat(this._toMercGeometry([t.coordinates],!0)):"MultiPolygon"===t.type&&(this._mercBoundary=this._mercBoundary.concat(this._toMercGeometry(t.coordinates,!0)))}.bind(this);e(this.options.boundary)}this._mercBbox=new L.Bounds;for(var i=0;i<this._mercBoundary.length;i++)t=new L.Bounds(this._mercBoundary[i][0]),this._mercBbox.extend(t.min),this._mercBbox.extend(t.max);return this._mercBoundary},_getClippedGeometry:function(e,i){var n,r,o,a,s,l=[];for(a=0;a<e.length;a++)if(n=[],0!==(r=L.PolyUtil.clipPolygon(e[a][0],i)).length){for(n.push(r),s=1;s<e[a].length;s++)(o=L.PolyUtil.clipPolygon(e[a][s],i)).length>0&&n.push(o);l.push(n)}if(0===l.length)return{isOut:!0};for(a=0;a<l.length;a++){if(!t(l[a][0],i))return{geometry:l};if(1===l[a].length)return{isIn:!0};for(s=1;s<l[a].length;s++)if(!t(l[a][s],i))return{geometry:l}}return{isOut:!0}},_getTileGeometry:function(t,e,i,n){if(!this.options.boundary)return{isIn:!0};var r,o=t+":"+e+":"+i,a=Math.pow(2,i),s=this._boundaryCache;if(s[o])return s[o];var l=this._getOriginalMercBoundary(),u=this.options.tileSize,h=new L.Bounds(new L.Point(t*u/a,e*u/a),new L.Point((t+1)*u/a,(e+1)*u/a));return n||h.intersects(this._mercBbox)?0===i?(s[o]={geometry:l},s[o]):(r=this._getTileGeometry(Math.floor(t/2),Math.floor(e/2),i-1,!0)).isOut||r.isIn?r:(s[o]=this._getClippedGeometry(r.geometry,h),s[o]):{isOut:!0}},_drawTileInternal:function(t,e,i,n){var r=this._getZoomForUrl(),o=this._getTileGeometry(e.x,e.y,r);if(o.isOut)n();else{var a=this.options.tileSize,s=a*e.x,l=a*e.y,u=Math.pow(2,r),h=t.getContext("2d"),y=new Image,c=function(){var e,i,r,a,c;if(!o.isIn){for(c=o.geometry,h.beginPath(),e=0;e<c.length;e++)for(i=0;i<c[e].length;i++)if(0!==c[e][i].length)for(h.moveTo(c[e][i][0].x*u-s,c[e][i][0].y*u-l),r=1;r<c[e][i].length;r++)h.lineTo(c[e][i][r].x*u-s,c[e][i][r].y*u-l);h.clip()}a=h.createPattern(y,"repeat"),h.beginPath(),h.rect(0,0,t.width,t.height),h.fillStyle=a,h.fill(),n()};this.options.crossOrigin&&(y.crossOrigin=""),y.onload=function(){t.complete=!0,setTimeout(c,0)},y.src=i}},onAdd:function(t){(L.TileLayer.Canvas||L.TileLayer).prototype.onAdd.call(this,t),this.options.trackAttribution&&(t.on("moveend",this._updateAttribution,this),this._updateAttribution())},onRemove:function(t){if((L.TileLayer.Canvas||L.TileLayer).prototype.onRemove.call(this,t),this.options.trackAttribution&&(t.off("moveend",this._updateAttribution,this),!this._attributionRemoved)){var e=L.TileLayer.BoundaryCanvas.prototype.getAttribution.call(this);t.attributionControl.removeAttribution(e)}},_updateAttribution:function(){var t=this._getOriginalMercBoundary(),e=this._map.getBounds(),i=L.bounds(this._map.project(e.getSouthWest(),0),this._map.project(e.getNorthEast(),0)),n=this._getClippedGeometry(t,i);if(this._attributionRemoved!==!!n.isOut){var r=L.TileLayer.BoundaryCanvas.prototype.getAttribution.call(this);this._map.attributionControl[n.isOut?"removeAttribution":"addAttribution"](r),this._attributionRemoved=!!n.isOut}}};L.version>="0.8"?L.TileLayer.BoundaryCanvas=L.TileLayer.extend({options:{boundary:null},includes:e,initialize:function(t,e){L.TileLayer.prototype.initialize.call(this,t,e),this._boundaryCache={},this._mercBoundary=null,this._mercBbox=null,this.options.trackAttribution&&(this._attributionRemoved=!0,this.getAttribution=null)},createTile:function(t,e){var i=document.createElement("canvas"),n=this.getTileUrl(t);return i.width=i.height=this.options.tileSize,this._drawTileInternal(i,t,n,L.bind(e,null,null,i)),i}}):L.TileLayer.BoundaryCanvas=L.TileLayer.Canvas.extend({options:{boundary:null},includes:e,initialize:function(t,e){L.Util.setOptions(this,e),L.Util.setOptions(this,{async:!0}),this._url=t,this._boundaryCache={},this._mercBoundary=null,this._mercBbox=null,this.options.trackAttribution&&(this._attributionRemoved=!0,this.getAttribution=null)},drawTile:function(t,e){var i,n=L.extend({},e);this._adjustTilePoint(n),i=this.getTileUrl(n),this._drawTileInternal(t,e,i,L.bind(this.tileDrawn,this,t)),this._getTileSize()!==this.options.tileSize&&(t.style.width=t.style.height=this._getTileSize()+"px")}}),L.TileLayer.boundaryCanvas=function(t,e){return new L.TileLayer.BoundaryCanvas(t,e)},L.TileLayer.BoundaryCanvas.createFromLayer=function(t,e){return t instanceof L.TileLayer?new L.TileLayer.BoundaryCanvas(t._url,L.extend({},t.options,e)):(console.warn("Your tileLayer doesn' instanceof L.TileLayer"),t)}}();
//# sourceMappingURL=/sm/c49e7660b0f21a8fbd61c69a4ab711aed35235d161617d548539dab2ef54ce7c.map